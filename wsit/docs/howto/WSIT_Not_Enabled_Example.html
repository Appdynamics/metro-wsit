<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <meta http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8">
  <title>Building a JAX-WS Application in the WSIT Environment</title>
  <meta name="GENERATOR" content="OpenOffice.org 1.9.104  (Linux)">
  <meta name="CREATED" content="20060418;8545000">
  <meta name="CHANGED" content="20060418;12145100">
  <style>
	<!--
		H2.western { font-family: "Albany", sans-serif; font-size: 14pt; font-style: italic }
		H2.cjk { font-family: "HG Mincho Light J"; font-size: 14pt; font-style: italic }
		H2.ctl { font-family: "Arial Unicode MS"; font-size: 14pt; font-style: italic }
	-->
	</style>
</head>
<body dir="ltr" lang="en-US">
<h1><a href="index.html">Getting Started with WSIT:</a></h1>
<h1>Building a JAX-WS Application in the WSIT Environment</h1>
<h2>Overview</h2>
The intent of this second installment of the
<span style="font-style: italic;">Getting Started with WSIT</span>
series is to demonstrate the steps required to build a
JAX-WS 2.0 web service starting both from Java code and from a WSDL
document, to deploy that application into a web container, and to
build a corresponding web service client application. In this
example, no WSIT-specific technologies will be enabled. It is
intended as a baseline from which to develop your understanding of
the larger WSIT environment. This article continues the <span
 style="font-style: italic;">Getting Started with WSIT</span> series
from the previous article <span style="font-weight: bold;"></span><a
 href="WSIT_Download_Build_Install.html">Downloading,&nbsp;
Building, and Installing WSIT</a>.<br>
<p style="margin-bottom: 0in;">Supporting code samples are included to
demonstrate building a JAX-WS web
service in the WSIT environment. The examples show how to develop a
web service both starting from Java source code and starting from an
existing WSDL document. For both scenarios, it shows how to develop a
corresponding client application from the web service's WSDL document.
The examples can be found in
the WSIT source tree here:<br>
</p>
<p style="margin-bottom: 0in; margin-left: 40px;"><span
 style="font-weight: bold;"></span><span style="font-family: monospace;">wsit/wsit/docs/howto/wsit-jaxws-fromjava
(<a href="wsit-jaxws-fromjava.zip">zip</a>)<br>
</span></p>
<p style="margin-bottom: 0in; margin-left: 40px;"><span
 style="font-weight: bold;"></span><span style="font-family: monospace;">wsit/wsit/docs/howto/wsit-jaxws-fromwsdl
(<a href="wsit-jaxws-fromwsdl.zip">zip</a>)<br>
</span></p>
<br>
As mentioned above, these examples do not enable any WSIT-specific
technologies. However, the following article in this series, <a
 href="WSIT_Enabled_Example.html">Enabling WSIT Functionality in a Web
Service Application</a>, builds on the information presented in this
document. It explains configuring a web service and its client to
enable WSIT technologies.<br>
<h2>Contents</h2>
<a href="#Prerequisites">Prerequisites</a><br>
<a href="#Environment">Environment Configuration Settings</a><br>
<a href="#Building_Server">Building a JAX-WS 2.0 Web Service</a><br>
<a href="#Deploying">Deploying the Web Service to a Web
Container</a><br>
<a href="#Building_Client">Building a JAX-WS 2.0 Web Service Client</a><br>
<a href="#Running">Running the Web Service Client</a><br>
<a href="#Summary">Summary and Resources</a><br>
<h2><a name="Prerequisites"></a>Prerequisites<br>
</h2>
<p style="margin-bottom: 0in;">The steps in this document require that
you have already installed the WSIT jars into your web container. It
also requires the following software be <span style="">installed</span>:
JDK 5.0 Update 2 or later, Apache Ant 1.6.5 or later, and GlassFish (or
Tomcat 5.5). If those
prerequisites are not installed, please review the&nbsp;<span
 style="font-weight: bold;"></span><a
 href="WSIT_Download_Build_Install.html#Prerequisites">Prerequisites</a>
section
of the previous article for details.</p>
<h2><a name="Environment"></a>Environment Configuration Settings<br>
</h2>
<b>Web Container “Listen” Port</b>
<p>The Java code and configuration files for the examples used in
this document presume that the web container is listening on IP port
8080. Port 8080 is the default “listen” port for both GlassFish
(domain1) and Tomcat. If you have changed the “listen” port, you
will need to edit the example source files to account for that. The
following is a list of the files which contain references to the
“listen” port.</p>
<ol style="font-family: monospace;">
  <li>wsit-jaxws-fromjava/src/fromjava/server/AddWebservice.java</li>
  <li>wsit-jaxws-fromjava/etc/custom-schema.xml</li>
  <li>wsit-jaxws-fromjava/etc/custom-client.xml</li>
  <li>wsit-jaxws-fromjava/etc/build.properties</li>
  <li>wsit-jaxws-fromwsdl/etc/custom-client.xml</li>
  <li>wsit-jaxws-fromwsdl/etc/build.properties<br>
  </li>
</ol>
<p><b>Web Container Home Directory</b></p>
<p>Before building and deploying the web service and its client, the
home directory of the web container must be set either as an
environment variable or as a property in the respective build.xml
file.</p>
<p style=""><i>Environment Variables</i></p>
<p style="">Assuming that you are running from the
command-line, it is probably simplest to set the appropriate
environment variable indicating the web container’s “home”
directory. For GlassFish, <span style="font-family: monospace;">AS_HOME</span>
should be set to the top-level
directory of the GlassFish installation. For Tomcat, <span
 style="font-family: monospace;">CATALINA_HOME</span>
needs to be set to the Tomcat top-level directory.</p>
<p style=""><i>Ant build.xml File</i></p>
<p style="">If you would rather not have to set
the environment variable for each new terminal session, you can edit
the build.xml file located at the top-level of each of the examples.
There are two commented lines, one each for GlassFish (<span
 style="font-family: monospace;">as.home</span>)
and Tomcat (<span style="font-family: monospace;">catalina.home</span>).
Simply uncomment the appropriate
line and edit the value for the directory name.</p>
<h2><a name="Building_Server"></a>Building a JAX-WS 2.0 Web Service<br>
</h2>
<p style="margin-bottom: 0in;"><b>Starting from Java</b></p>
<p style="margin-bottom: 0in;">One way to
create a web service application is to start by coding the endpoint
in Java. If you are developing your Java web service from scratch or
have an existing Java class you wish to expose as a web service, this
is the most direct path.</p>
<p style="margin-bottom: 0in;">The <a
 href="http://www.jcp.org/en/jsr/detail?id=224">Java
API for XML Web Services (JAX-WS) 2.0, JSR 224</a> relies heavily on
the use of annotations as specified in <a
 href="http://www.jcp.org/en/jsr/detail?id=175">A
Metadata Facility for the Java Programming Language</a> (JSR 175) and
<a href="http://www.jcp.org/en/jsr/detail?id=181">Web Services
Metadata for the Java Platform</a> (JSR 181), as well as additional
annotations defined by the JAX-WS 2.0 specification.</p>
<p style="margin-bottom: 0in;">The web service is
written as a normal Java class. Then the class and its methods that
are to be exposed are annotated with specific web service
annotations, @WebService and @WebMethod. The following code snippet
shows an example:</p>
<p
 style="margin-left: 0.79in; margin-bottom: 0in; font-family: monospace;">
</p>
<div style="margin-left: 40px; font-family: monospace;"><span
 style="font-family: monospace;">@WebService
</span><br style="font-family: monospace;">
<span style="font-family: monospace;">public class AddNumbersImpl {<br>
</span>
<div style="margin-left: 40px;">@WebMethod<span
 style="font-family: monospace;"></span><br>
<span style="font-family: monospace;"></span></div>
</div>
<div style="font-family: monospace;">
<div style="margin-left: 80px;"><span style="font-family: monospace;"></span>public
int
addNumbers(int number1, int number2) throws
AddNumbersException {<br>
</div>
</div>
<div style="margin-left: 40px; font-family: monospace;">
<div style="margin-left: 40px;">
<div style="margin-left: 40px;">if (number1 &lt; 0
|| number2 &lt; 0) {<span style="font-family: monospace;"></span><br>
</div>
<span style="font-family: monospace;"></span></div>
<div style="margin-left: 40px;">
<div style="margin-left: 80px;"><span style="font-family: monospace;"></span>throw
new
AddNumbersException("Negative number cant
be added!",<span style="font-family: monospace;"></span><br>
</div>
<span style="font-family: monospace;"></span></div>
<div style="margin-left: 40px;">
<div style="margin-left: 80px;"><span style="font-family: monospace;"></span>"Numbers:
" +
number1 + ", " +
number2);<span style="font-family: monospace;"></span><br>
</div>
<span style="font-family: monospace;"></span></div>
<div style="margin-left: 80px;"><span style="font-family: monospace;"></span>}<br>
</div>
<div style="margin-left: 80px;">return number1 +
number2;<br>
</div>
<div style="margin-left: 40px;">}<br>
</div>
}</div>
<p style="margin-bottom: 0in;">If you are using
the GlassFish web container, the web service in the <span
 style="font-family: monospace;">wsit-jaxws-fromjava</span>
example can be compiled and bundled simply by invoking: <br>
</p>
<p style="margin-bottom: 0in; margin-left: 40px;"><span
 style="font-family: monospace;">ant
server</span><br>
</p>
<p style="margin-bottom: 0in;">If using Tomcat, the command-line would
be:<br>
</p>
<p style="margin-bottom: 0in; margin-left: 40px;"><span
 style="font-family: monospace;">ant
-Duse.tomcat=true server</span><br>
</p>
<p style="margin-bottom: 0in;">The <span
 style="font-family: monospace;">server</span> target in&nbsp;
<span style="font-family: monospace;">build.xml</span> in turn invokes
the tools necessary to process the
annotations and compile the sources, and to bundle the Java class files
and
configuration files into a deployable web archive (WAR file). The WAR
file will be <span style="font-family: monospace;">build/war/wsit-jaxws-fromjava.war.</span>
The tools that were called by ant
during this step are briefly described next.</p>
<p style="margin-bottom: 0in;">The JAX-WS tool <span
 style="font-family: monospace;">apt</span> (annotation processing
tool) processes the annotated source
code and invokes the compiler itself, resulting in the class files
for each of the Java source files. In the accompanying <span
 style="font-family: monospace;">fromjava</span>
example, the <span style="font-family: monospace;">ant</span> target <span
 style="font-family: monospace;">build-server-java</span> in <span
 style="font-family: monospace;">build.xml</span> handles
this portion of the process. Then the individual class files are
bundled together along with the web service’s supporting
configuration files into the application's WAR
file. It is this file that will be deployed to the web container in
the next step. The <span style="font-family: monospace;">create-war</span>
target takes care of this.</p>
<p style="margin-bottom: 0in;"><b>Starting from WSDL</b></p>
<p style="margin-bottom: 0in;">Typically, you
would start from WSDL to build your web service if you want to
implement a web service that is already defined either by a standard
or an existing instance of the service. In either case, the WSDL
already exists. The JAX-WS <span style="font-family: monospace;">wsimport</span>
tool will process the
existing WSDL document, either from a local copy on disk or by
retrieving it from a network address. An example of manually
accessing a service’s WSDL using a web browser is shown below as
part of the section on verifying deployment. </p>
<p style="margin-bottom: 0in;">As in the previous
example, to build the <span style="font-family: monospace;">wsit-jaxws-fromwsdl</span>
service for GlassFish, you can simply invoke:<br>
</p>
<p style="margin-bottom: 0in; margin-left: 40px;"><span
 style="font-family: monospace;">ant
server</span><br>
</p>
<p style="margin-bottom: 0in;">Otherwise for Tomcat use:<br>
</p>
<p style="margin-bottom: 0in; margin-left: 40px;"><span
 style="font-family: monospace;">ant -Duse.tomcat=true
server</span><br>
</p>
<p style="margin-bottom: 0in;"><span style="font-family: monospace;">Wsimport</span>
will take the WSDL description and generate a corresponding Java
interface and other supporting classes. Then the Java compiler needs
to be called to compile both the user’s code and the generated
code. Finally, the class files are bundled together into the WAR
file. The details can be seen in the<span
 style="font-family: monospace;"> wsit-jaxws-fromwsdl build.xml</span>
file
as the <span style="font-family: monospace;">build-server-wsdl</span>
and <span style="font-family: monospace;">create-war</span> targets.<br>
</p>
<span style="font-family: &quot;albany&quot;,sans-serif;"><span
 style="font-style: italic;"><span style="font-weight: bold;"></span></span></span>
<h2><span style="font-family: &quot;albany&quot;,sans-serif;"><span
 style="font-style: italic;"><span style="font-weight: bold;"></span></span></span><a
 name="Deploying"></a>Deploying the Web Service to a Web
Container</h2>
For both the “from Java” and “from WSDL” scenarios
described above, the resulting application is deployed in the same
manner. However, the details of the deployment process differ slightly
between
the GlassFish and Tomcat web containers.
<p><b>Deploying to GlassFish</b></p>
<p style="">For development purposes, it is
simplest to use the “autodeploy” facility of GlassFish. To do so,
copy your application’s WAR file to the <span
 style="font-family: monospace;">autodeploy</span> directory
for the domain to which you want to deploy. If you are using the
default domain, <span style="font-family: monospace;">domain1</span>,
set up by the GlassFish installation process,
then the appropriate directory path would be <span
 style="font-family: monospace;">&lt;glassfish-install-home&gt;/domains/domain1/autodeploy</span>.
</p>
<p style="">The <span style="font-family: monospace;">build.xml</span>
file which
accompanies this example has a deploy target for GlassFish. Invoke that
target by running <span style="font-family: monospace;">ant </span>in
the top-level
directory of the respective examples, either <span
 style="font-family: monospace;">fromjava</span> or <span
 style="font-family: monospace;">fromwsdl</span>, as follows.<br>
</p>
<p style="margin-left: 40px;"><span style="font-family: monospace;">ant
deploy</span><br>
</p>
<p><b>Deploying to Tomcat</b></p>
<p style="">Tomcat also has an “autodeploy”
feature. That feature can be turned off but is enabled by Tomcat’s
“out of the box” configuration settings. Look in <span
 style="font-family: monospace;">&lt;tomcat-install-directory&gt;/conf/server.xml</span>
for the value
of “autoDeploy” if you are unsure. Assuming “autodeploy” is
enabled, then copying your application to <span
 style="font-family: monospace;">&lt;tomcat-install-home&gt;/webapps</span>
is all that is necessary.
Again, there is a target in the Ant build.xml file which accompanies
this sample. The deploy target can be invoked by running the following
command in the example’s top-level directory.<br>
</p>
<p style="margin-left: 40px;"><span style="font-family: monospace;">ant
-Duse.tomcat=true deploy</span></p>
<p><b>Verifying Successful Deployment</b></p>
<p style="">One basic test to verify that the
application has deployed properly is to use a web browser to retrieve
the
application’s WSDL from its hosting web container. The following
URLs would retrieve the WSDL from each of the two example services.
If you are running your web browser and web container on different
machines, you will need to replace “localhost” with the name of
the machine hosting your web service.&nbsp; It is also worth ensuring
that your web container is actually running at this point.<br>
</p>
<p style="margin-left: 40px;"><a
 href="http://localhost:8080/wsit-jaxws-fromwsdl/addnumbers?wsdl">http://localhost:8080/wsit-jaxws-fromjava/addnumbers?wsdl</a></p>
<p style="margin-left: 40px;"><a
 href="http://localhost:8080/wsit-jaxws-fromwsdl/addnumbers?wsdl">http://localhost:8080/wsit-jaxws-fromwsdl/addnumbers?wsdl</a></p>
<p style="">If the browser displays a pageful of
XML, things are working. If not, check the web container logs for
any error messages related to the the sample WAR you have just
deployed. For GlassFish, the appropriate log can be found at <span
 style="font-family: monospace;">&lt;glassfish-install-directory&gt;/domains/&lt;your-domain&gt;/logs/server.log</span>.
For Tomcat 5.5, the appropriate log file will be <span
 style="font-family: monospace;">&lt;tomcat-install-directory&gt;/logs/catalina.out</span>.</p>
<h2><a name="Building_Client"></a>Building a JAX-WS 2.0 Web Service
Client<br>
</h2>
Unlike developing a web service provider, the process for creating
a web service client application will always start with an existing
WSDL document. This process is similar to the steps taken when
building a service from an existing WSDL. Typically, the WSDL will
be retrieved directly from a web service provider by the <span
 style="font-family: monospace;">wsimport</span>
tool . <span style="font-family: monospace;">Wsimport</span> then
generates the corresponding Java source
code for the described interface. <span style="font-family: monospace;">Javac,</span>
the Java compiler, is
then called to compile the source into class files. The
programmer’s code uses the generated classes to access the web
service. Here is an example code snippet:
<p style="font-family: monospace; margin-left: 40px;">AddNumbersPortType
port = new
AddNumbersService().getAddNumbersPort ();<br>
int number1 = 10;<br>
int number2 = 20;<br>
int result = port.addNumbers (number1, number2);</p>
<p>For both of the associated examples, invoking <span
 style="font-family: monospace;">ant client</span> (or <span
 style="font-family: monospace;">ant -Duse.tomcat=true</span>) will run
<span style="font-family: monospace;">wsimport</span> to retrieve the
service’s WSDL and compile the source.</p>
<h2><a name="Running"></a>Running the Web Service Client<br>
</h2>
<p>For both of the accompanying examples, it is simplest to execute
the resulting command-line clients via the <span
 style="font-family: monospace;">run</span> target of the
build.xml file. Essentially that target simply runs Java with the
name of the client’s class, such as <span
 style="font-family: monospace;">java
fromwsdl.client.AddNumbersClient</span>. However, for convenience the <span
 style="font-family: monospace;">run</span> target takes care of
passing a list of jar files via Java’s <span
 style="font-family: monospace;">-classpath</span> option. When you
invoke the <span style="font-family: monospace;">run</span> target,
you
can expect to see output from the client similar to the following:</p>
<p style="font-family: monospace; margin-left: 40px;">[java] May 4,
2006 2:45:50 PM
[com.sun.xml.ws.policy.jaxws.PolicyWSDLParserExtension]&nbsp;
addClientConfigToMap<br>
[java] WARNING: Optional client configuration file URL is missing. No
client configuration is processed.<br>
[java] Invoking
addNumbers(10, 20)<br>
[java] The
result of adding 10 and 20 is 30.</p>
<p style="font-family: monospace; margin-left: 40px;"> [java] Invoking
addNumbers(-10, 20)<br>
[java] Caught
AddNumbersFault_Exception: Numbers: -10, 20<br>
</p>
The <span style="font-family: monospace;">WARNING</span> line above is
expected for both of these examples. Given that no WSIT technologies
are enabled, a configuration file is unnecessary. More information will
be provided on WSIT configuration files in the following article.<br>
<h2><a name="Summary"></a>Summary and Resources<br>
</h2>
<span style="">This article highlighted the steps that will be common
to building,
deploying, and running almost any JAX-WS web service. However there
are many more details. </span>For further information on
developing Java web services with JAX-WS 2.0, WSIT, Netbeans,
GlassFish, and more, please visit the links below.
<p style="margin-bottom: 0in;"><a href="http://wsit.dev.java.net">WSIT
at java.net<br>
</a><a href="http://glassfish.dev.java.net">GlassFish at java.net</a><br>
<a href="http://jax-ws.dev.java.net/"><span
 style="text-decoration: underline;">JAXWS at java.net</span></a><br>
<a href="http://www.netbeans.org">Netbeans</a>,
<a href="http://www.jcp.org/en/jsr/detail?id=224">Developing Web
Services with
NetBeans IDE 5.5<br>
Java
API for XML Web Services (JAX-WS) 2.0</a> (JSR 224)<a
 href="https://jaxws.dev.java.net"><span
 style="text-decoration: underline;"></span></a><br>
<a href="http://www.jcp.org/en/jsr/detail?id=175">A
Metadata Facility for the Java Programming Language</a> (JSR 175)<br>
<a href="http://www.jcp.org/en/jsr/detail?id=181">Web
Services Metadata for the Java Platform</a> (JSR 181)<br>
<a href="http://java.sun.com/j2se/1.5.0/download.jsp">Sun Java
SE 5.0 Developers Kit (JDK 5.0)</a></p>
<p style="margin-bottom: 0in;"><br>
</p>
</body>
</html>
